## Methods

### Data harmonization
For this subchallenge, the training dataset's characteristics were very different compared to those of the test set.
Importantly, training set contains *in vivo* transcription as described in [@doi:10.1126/science.1260403] while test set contains *in vitro* transcription.
Other differences in data collection, synchronization, microarray platforms, preprocessing steps, etc. have been detailed on the [challenge website](https://www.synapse.org/#!Synapse:syn16924919/wiki/590948).
We first impute the missing data points using the KNN imputation method  with k = 10 via the [fancyimpute package](https://pypi.org/project/fancyimpute/).
Next, to adjust for batch effects between the two datasets, we apply the *ComBat* algorithm [@doi:10.1093/biostatistics/kxj037] from the *sva* R package [@doi:10.1093/bioinformatics/bts034] on the transcription data.
We assess the effect of the adjustment by examining the principal component analysis (PCA) plots on the raw and processed data. 

### Gene feature selection
Using the STatistical Inference Relief (STIR) algorithm [@doi:10.1093/bioinformatics/bty788], we selected the genes with adjusted STIR P values < 0.05.
Specifically, with the MultiSURF neighborhood, STIR nearest-neighbors to select features whose association with an outcome may be due to epistasis 

### Automated machine learning for model training
[TPOT details here...]
We used balanced accuracy as our scoring function.

### Test sample selection
While there is one single sample per isolate in the training set, there are eight samples for each of the 32 isolates in the test set (most have 2 biological replicates, 2 time points: 6 hours and 24 hours post invasion, perturbed with 5nM DHA (DHA) or perturbed with DMSO (UT)).
Therefore, to obtain one prediction per isolate, we need to take caution in selecting which test samples to predict on.
First, because the training samples are unperturbed, we discard the perturbed samples in the testing set, keeping only the controls (UT).
Second, we analyze the developmental stage of each biological replicate at seperate timepoints.
[...]
Transcriptional profiles in the test set were compared against the 3D7 sample from [@doi:10.1371/journal.pbio.0000005].

### Non-genetic features consideration
Because all samples from the test data were collected from the Thailand-Myanmar border, for now, we ignore the `Country` feature.
In the future, however, perhaps we can place more weights on the training samples that are geographically closer to this region.
We also ignore the `Kmeans.Grp` feature that is cluster groups corresponding to three types of transcription profile based on parasite developmental stage.

### Availability
Detailed preprocessing, modeling and analysis code for this study is available at [https://github.com/EpistasisLab/malaria-challenge](https://github.com/EpistasisLab/malaria-challenge).

